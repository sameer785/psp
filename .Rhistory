group_by(hsapiens_homolog_associated_gene_name) %>%
slice_tail()
trio.res %>% filter (hsapiens_homolog_associated_gene_name=='SHANK3')
trio.res <- res_fxs %>%
dplyr::select(hsapiens_homolog_associated_gene_name, t.KO.over.WT) %>%
na.omit() %>%
distinct() %>%
group_by(hsapiens_homolog_associated_gene_name) %>%
slice_max(abs(t.KO.over.WT))
dim(trio.res)
pathways.go <- gmtPathways("~/Google Drive/seqTables/geneSets/c5.mf.v7.0.symbols.gmt")
pathways.go <- gmtPathways("~/Google Drive/seqTables/geneSets/c5.mf.v7.0.symbols.gmt")
fgseaRes_fxs <- fgsea(pathways=pathways.go, stats=ranks, nperm=1000)
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj)
fgseaResTidy_fxs_up %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_down <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(NES, padj)
fgseaResTidy_fxs_down %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_up %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
pathways.go <- gmtPathways("~/Google Drive/seqTables/geneSets/c5.bp.v7.0.symbols.gmt")
pathways.go <- gmtPathways("~/Google Drive/seqTables/geneSets/c5.bp.v7.0.symbols.gmt")
fgseaRes_fxs <- fgsea(pathways=pathways.go, stats=ranks, nperm=1000)
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj)
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj)
fgseaResTidy_fxs_up %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_down <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(NES, padj)
fgseaResTidy_fxs_down %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
pathways.go <- gmtPathways("~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt")
pathways.go <- gmtPathways("~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt")
fgseaRes_fxs <- fgsea(pathways=pathways.go, stats=ranks, nperm=1000)
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
fgseaResTidy_fxs_up %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_up %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
fgseaRes_fxs <- fgsea(pathways=pathways.go, stats=ranks, nperm=1000)
fgseaRes_fxs <- fgsea(pathways=pathways.go, stats=ranks, nperm=1000)
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj)
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj)
fgseaResTidy_fxs_up %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
fgseaResTidy_fxs_up <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(desc(NES), padj) %>%
DT::datatable()
fgseaResTidy_fxs_down <- fgseaRes_fxs %>%
as_tibble() %>%
arrange(NES, padj) %>%
dplyr::select(-ES, -nMoreExtreme) %>%
DT::datatable()
fgseaResTidy_fxs_up
source('~/Desktop/broad/psp/functions/doGoAnalysis.R', echo=TRUE)
trio.xls <- trio.xls %>% mutate(t.KO.over.WT = t.WT.over.KO*(-1))
goPathways <- "~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt"
doGoAnalysis(trio.xls, goPathways)
(trio.go.up, trio.go.down) <- doGoAnalysis(trio.xls, goPathways)
[trio.go.up, trio.go.down] <- doGoAnalysis(trio.xls, goPathways)
source('~/Desktop/broad/psp/functions/doGoAnalysis.R', echo=TRUE)
trio.go <- doGoAnalysis(trio.xls, goPathways)
trio.go$up
trio.go$down
# Load data and libraries
rm(list=ls())
require(readxl)
require(tidyverse)
require(tm)
require(ggfortify)
require(PerformanceAnalytics)
require(PCAtools)
require(reshape2)
require(ggbeeswarm)
require(EnhancedVolcano)
require(RColorBrewer)
require(rlang)
files.sources = list.files("../functions" , full.names = TRUE)
invisible(lapply(files.sources, source))
shank3.xls <- read_xlsx("../data/results_PSD-Shank3-proteome_Two-sample_mod_T_2020-07-22.xlsx")
shank3.xls <- shank3.xls %>% drop_na(logFC.WT.over.KO)
shank3.abundances <- shank3.xls %>% dplyr::select(starts_with("Shank3_PSD_TMT11_Proteome.."))
#Renaming columns for clarity
shank3.sampleSheet <- makeSampleSheet(shank3.abundances)
colnames(shank3.abundances) <- shank3.sampleSheet$cleanId
# Remove any rows with NA
shank3.abundances.clean <- na.omit(shank3.abundances)
shank3.abundances.pca.plot <- makePcaPlot(shank3.abundances.clean, shank3.sampleSheet$color)
shank3.abundances.pca.plot
###
shank3.abundances.clean.log <- log(shank3.abundances.clean+abs(min(shank3.abundances.clean))+1)
shank3.abundances.clean.log.pca.plot <- makePcaPlot(shank3.abundances.clean.log, shank3.sampleSheet$color)
shank3.abundances.clean.log.pca.plot
# No inherent structure in the data
# Samples do not vary primarily by genotype
# Check abundance of shank3 protein
# Major isoform?
shank3.shank3.abundance.m <- getAbundanceOfProtein(shank3.xls,
'A0A0A0MQD5',
"Shank3_PSD_TMT11_Proteome..",
shank3.sampleSheet)
shank3.shank3.abundance.plot <- makeAbundancePlot(shank3.shank3.abundance.m)
shank3.shank3.abundance.plot
# Isoform 9
shank3.shank3.iso.abundance.m <- getAbundanceOfProtein(shank3.xls,
"Q4ACU6",
"Shank3_PSD_TMT11_Proteome..",
shank3.sampleSheet)
shank3.shank3.iso.abundance.plot <- makeAbundancePlot(shank3.shank3.iso.abundance.m)
shank3.shank3.iso.abundance.plot
#Plotting FDR adjusted p value against LFC
shank3.xls <- shank3.xls %>% dplyr::mutate(logFC.KO.over.WT = logFC.WT.over.KO*(-1))
vPlot <- makeVolcanoPlot(shank3.xls)
vPlot
borislavLabels <- c("Trio", "Shank3", "Grin1", "Nrcam", "Dlgap1", "Clu", "Prrt1", "Zdhhc5", "Nono", "Cers6", "Uba52", "Rpl29")
vPlot2 <- makeVolcanoPlot(shank3.xls, borislavLabels)
vPlot2
shank3.xls <- shank3.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
shank3.xls <- setupBins(shank3.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(shank3.xls)
vPlot3 <- makeVolcanoPlot(shank3.xls, borislavLabels, 0.8, keyvals)
vPlot3
shank3.xls <- shank3.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
shank3.xls <- setupBins(shank3.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(shank3.xls)
vPlot3 <- makeVolcanoPlot(shank3.xls, NULL, 0.8, keyvals)
vPlot3
shank3.xls <- shank3.xls %>% mutate(t.KO.over.WT = t.WT.over.KO*(-1))
goPathways <- "~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt"
shank3.go <- doGoAnalysis(shank3.xls, goPathways)
source('~/Desktop/broad/psp/functions/doGoAnalysis.R', echo=TRUE)
shank3.xls <- shank3.xls %>% mutate(t.KO.over.WT = t.WT.over.KO*(-1))
goPathways <- "~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt"
shank3.go <- doGoAnalysis(shank3.xls, goPathways)
shank3.go$up
shank3.go$down
shank3.go$up
shank3.go$down
#Stratify cumulative frequency by protein MW
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(shank3.xls)
lfcCumFreqPlot
source('~/Desktop/broad/psp/functions/makeStratifiedCumLfcPlot.R', echo=TRUE)
#Stratify cumulative frequency by protein MW
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(shank3.xls)
lfcCumFreqPlot
plot(density(trio.xls %>% select(adj.P.Val.WT.over.KO)))
# Load data and libraries
rm(list=ls())
require(readxl)
require(tidyverse)
require(tm)
require(ggfortify)
require(reshape2)
require(ggbeeswarm)
require(EnhancedVolcano)
require(RColorBrewer)
require(fgsea)
trio.abundances <- trio.xls %>% dplyr::select(starts_with("Trio_PSD_TMT11_Proteome.."))
files.sources = list.files("../functions" , full.names = TRUE)
invisible(lapply(files.sources, source))
trio.xls <- read_xlsx("../data/results_PSD-Trio-proteome_Two-sample_mod_T_2020-07-24.xlsx")
trio.xls <- trio.xls %>% drop_na(logFC.WT.over.KO)
trio.abundances <- trio.xls %>% dplyr::select(starts_with("Trio_PSD_TMT11_Proteome.."))
#Renaming columns for clarity
trio.sampleSheet <- makeSampleSheet(trio.abundances)
colnames(trio.abundances) <- trio.sampleSheet$cleanId
# Remove any rows with NA
trio.abundances.clean <- na.omit(trio.abundances)
trio.abundances.pca.plot <- makePcaPlot(trio.abundances.clean, trio.sampleSheet$color)
trio.abundances.pca.plot
###
trio.abundances.clean.log <- log(trio.abundances.clean+abs(min(trio.abundances.clean))+1)
trio.abundances.clean.log.pca.plot <- makePcaPlot(trio.abundances.clean.log, trio.sampleSheet$color)
trio.abundances.clean.log.pca.plot
# No inherent structure in the data
# Samples do not vary primarily by genotype
# Check abundance of Trio protein
trio.trio.abundance.m <- getAbundanceOfProtein(trio.xls,
'Q0KL02',
"Trio_PSD_TMT11_Proteome..",
trio.sampleSheet)
trio.trio.abundance.plot <- makeAbundancePlot(trio.trio.abundance.m)
trio.trio.abundance.plot
plot(density(trio.xls %>% select(adj.P.Val.WT.over.KO)))
trio.xls %>% select(adj.P.Val.WT.over.KO)
density(trio.xls %>% select(adj.P.Val.WT.over.KO))
plot(density(trio.xls$adj.P.Val.WT.over.KO))
plot(density(trio.xls$adj.P.Val.WT.over.KO), xlim=c(0,1))
plot(density(trio.xls$P.Value.WT.over.KO), xlim=c(0,1))
sum(trio.xls$P.Value.WT.over.KO > 0.1)
sum(trio.xls$P.Value.WT.over.KO > 0.01)
sum(trio.xls$P.Value.WT.over.KO > 0.01)
sum(trio.xls$P.Value.WT.over.KO < 0.01)
sum(trio.xls$P.Value.WT.over.KO < 0.05)
#Plotting FDR adjusted p value against LFC
trio.xls <- trio.xls %>% dplyr::mutate(logFC.KO.over.WT = logFC.WT.over.KO*(-1))
vPlot <- makeVolcanoPlot(trio.xls)
vPlot
borislavLabels <- c("Trio", "Grin1", "Nrcam", "Dlgap1", "Clu", "Prrt1", "Zdhhc5", "Nono", "Cers6", "Uba52", "Rpl29")
vPlot2 <- makeVolcanoPlot(trio.xls, borislavLabels)
vPlot2
trio.xls <- trio.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
trio.xls <- setupBins(trio.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(trio.xls)
vPlot3 <- makeVolcanoPlot(trio.xls, borislavLabels, 0.8, keyvals, c(0.1,0.9))
vPlot3
trio.xls <- trio.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
trio.xls <- setupBins(trio.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(trio.xls)
vPlot3 <- makeVolcanoPlot(trio.xls, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot3
#Stratify cumulative frequency by protein MW
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(trio.xls)
lfcCumFreqPlot
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T, row.names=1)
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T, row.names=1)
geneLengths <- geneLengths[,c(1:3)]
head(geneLengths)
head(geneLengths)
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
head(geneLengths)
res <- inner_join(trio.xls, bm, by=c("geneSymbol"="gene_id"))
head(res)
res <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
head(res)
head(geneLengths)
head(res$length)
res <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
dim(resLen)
resLen <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
dim(trio.xls)
dim(resLen)
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
resLen <- setupBins(resLen, "logAAsize", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
debugSource('~/Desktop/broad/psp/functions/setupBins.R', echo=TRUE)
resLen <- setupBins(resLen, "logAAsize", c(0,9.5,10.25,11.25,12,12.5,16))
resHist
hist(resLen$logAAsize)
hist(resLen$aaSize)
hist(resLen$logAAsize)
sa,-hist(resLen$logAAsize)
sa-hist(resLen$logAAsize)
sa<-hist(resLen$logAAsize)
sa$breaks
sa<-hist(resLen$logAAsize, breaks=6)
sa$breaks
resLen$logAAsize
resLen$length
resLen[1,]
resLen %>% select(geneSymbol=='Trio')
resLen %>% select(gene_id=='Trio')
resLen %>% select(transcript_id.s.=='Trio')
resLen %>% filter(transcript_id.s.=='Trio')
resLen %>% filter(geneSymbol=='Trio')
resLen %>% filter(geneSymbol=='Trio') %>% select(aaSize, logAAsize)
resLen %>% filter(geneSymbol=='Trio') %>% select(length, aaSize, logAAsize)
sa$breaks
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
resLen <- setupBins(resLen, "logAAsize", c(4,6,8,10,12,14,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(trio.xls, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
resLen <- setupBins(resLen, "logAAsize", c(0,6,8,10,12,14,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(trio.xls, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
keyvals <- colorizeBins(resLen)
keyvals
length(keyvals)
length(resLen)
dim(resLen)
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
resLen <- setupBins(resLen, "logAAsize", c(0,6,8,10,12,14,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
sa<-hist(resLen$logAAsize)
sa<-hist(resLen$logAAsize, breaks=6)
sa$breaks
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,7,8.5,10.25,11.75,13,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,7,8.5,10.25,11.75,12,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,7,8.5,10.25,11.25,12,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,6.5,8.5,10.25,11.25,12,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,6.5,7.5,10.25,11.25,12,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,6.5,7.5,9,11.25,12,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,6.5,7.5,9,11,12,16))
sa$counts
sa<-hist(resLen$logAAsize, breaks=c(0,6.5,7.5,9,10.5,12,16))
sa$counts
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(trio.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
resLen <- setupBins(resLen, "logAAsize", c(0,6.5,7.5,9,10.5,12,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
vPlot4
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(trio.xls)
lfcCumFreqPlot
lfcCumFreqPlot
resLen$lfcBins
sum(resLen$lfcBins==1)
sum(resLen$lfcBins==2)
sum(resLen$lfcBins==3)
sum(resLen$lfcBins==4)
sum(resLen$lfcBins==5)
sum(resLen$lfcBins==6)
trio.xls <- trio.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
trio.xls <- setupBins(trio.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(trio.xls)
sum(resLen$lfcBins==6)
sum(resLen$lfcBins==3)
trio.xls <- trio.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
trio.xls <- setupBins(trio.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(trio.xls)
vPlot3 <- makeVolcanoPlot(trio.xls, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot3
sum(trio.xls$lfcBins==3)
sum(trio.xls$lfcBins==4)
sum(trio.xls$lfcBins==5)
sum(trio.xls$lfcBins==6)
# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins.
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)
lfcCumFreqPlot
# Load data and libraries
rm(list=ls())
require(readxl)
require(tidyverse)
require(tm)
require(ggfortify)
require(PerformanceAnalytics)
require(PCAtools)
require(reshape2)
require(ggbeeswarm)
require(EnhancedVolcano)
require(RColorBrewer)
require(fgsea)
files.sources = list.files("../functions" , full.names = TRUE)
invisible(lapply(files.sources, source))
shank3.xls <- read_xlsx("../data/results_PSD-Shank3-proteome_Two-sample_mod_T_2020-07-22.xlsx")
shank3.xls <- shank3.xls %>% drop_na(logFC.WT.over.KO)
shank3.abundances <- shank3.xls %>% dplyr::select(starts_with("Shank3_PSD_TMT11_Proteome.."))
#Renaming columns for clarity
shank3.sampleSheet <- makeSampleSheet(shank3.abundances)
colnames(shank3.abundances) <- shank3.sampleSheet$cleanId
# Remove any rows with NA
shank3.abundances.clean <- na.omit(shank3.abundances)
shank3.abundances.pca.plot <- makePcaPlot(shank3.abundances.clean, shank3.sampleSheet$color)
shank3.abundances.pca.plot
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(shank3.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
##### CDS length distribution is shifted left in the PSD compared to tissue RF. Why??
resLen <- setupBins(resLen, "logAAsize", c(0,6.5,7.5,9,10.5,12,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))
#Plotting FDR adjusted p value against LFC
shank3.xls <- shank3.xls %>% dplyr::mutate(logFC.KO.over.WT = logFC.WT.over.KO*(-1))
vPlot <- makeVolcanoPlot(shank3.xls)
vPlot
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(shank3.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
##### CDS length distribution is shifted left in the PSD compared to tissue RF. Why??
resLen <- setupBins(resLen, "logAAsize", c(0,6.5,7.5,9,10.5,12,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins.
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)
lfcCumFreqPlot
source('~/Desktop/broad/psp/functions/makeStratifiedCumLfcPlot.R', echo=TRUE)
# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins.
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)
lfcCumFreqPlot
#Stratify by CDS length
geneLengths <- read.csv("~/bioChem/S3.genes.results", sep="\t", header=T)
geneLengths <- geneLengths[,c(1:3)]
resLen <- inner_join(shank3.xls, geneLengths, by=c("geneSymbol"="gene_id"))
resLen$aaSize <- resLen$length/3
resLen$logAAsize <- log2(resLen$aaSize)
##### CDS length distribution is shifted left in the PSD compared to tissue RF. Why??
resLen <- setupBins(resLen, "logAAsize", c(0,6.5,7.5,9,10.5,12,16))
keyvals <- colorizeBins(resLen)
vPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))
vPlot4
# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins.
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)
lfcCumFreqPlot
source('~/Desktop/broad/psp/functions/makeStratifiedCumLfcPlot.R', echo=TRUE)
# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins.
lfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)
lfcCumFreqPlot
lfcCumFreqPlot
shank3.xls <- shank3.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))
shank3.xls <- setupBins(shank3.xls, "log_protein_mw", c(0,9.5,10.25,11.25,12,12.5,16))
keyvals <- colorizeBins(shank3.xls)
vPlot3 <- makeVolcanoPlot(shank3.xls, NULL, 0.8, keyvals)
vPlot3
vPlot3
#Plotting FDR adjusted p value against LFC
shank3.xls <- shank3.xls %>% dplyr::mutate(logFC.KO.over.WT = logFC.WT.over.KO*(-1))
vPlot <- makeVolcanoPlot(shank3.xls)
vPlot
# Check abundance of shank3 protein
# Major isoform?
shank3.shank3.abundance.m <- getAbundanceOfProtein(shank3.xls,
'A0A0A0MQD5',
"Shank3_PSD_TMT11_Proteome..",
shank3.sampleSheet)
shank3.shank3.abundance.plot <- makeAbundancePlot(shank3.shank3.abundance.m)
shank3.shank3.abundance.plot
# Isoform 9
shank3.shank3.iso.abundance.m <- getAbundanceOfProtein(shank3.xls,
"Q4ACU6",
"Shank3_PSD_TMT11_Proteome..",
shank3.sampleSheet)
shank3.shank3.iso.abundance.plot <- makeAbundancePlot(shank3.shank3.iso.abundance.m)
shank3.shank3.iso.abundance.plot
plot(density(shank3.xls$adj.P.Val.WT.over.KO), xlim=c(0,1))
plot(density(trio.xls$P.Value.WT.over.KO), xlim=c(0,1))
plot(density(shank3.xls$P.Value.WT.over.KO), xlim=c(0,1))
sum(trio.xls$P.Value.WT.over.KO < 0.05)
sum(shank3.xls$P.Value.WT.over.KO < 0.05)
