{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Trio PSD proteome analysis\"\noutput:\n  html_document: default\n  html_notebook: default\n---\n\nSameer Aryal \nPostdoctoral Associate\nSheng Laboratory\nBroad Institute of MIT and Harvard\n\nOct. 9, 2020\n\nHow does genetically removing Trio alter the postsynaptic density (PSD) proteome?\nExamining TMT labeled PSD proteome from WT, Trio/+, and Trio/Trio mice. \nExperiment carried out by Borislav Dejanovic. \n\n```{r}\nrm(list=ls())\nrequire(readxl)\nrequire(tidyverse)\nrequire(tm)\nrequire(ggfortify)\nrequire(reshape2)\nrequire(ggbeeswarm)\nrequire(EnhancedVolcano)\nrequire(RColorBrewer)\nrequire(fgsea)\n```\nLoading data and helper functions. \n\n```{r}\nfiles.sources = list.files(\"../functions\" , full.names = TRUE)\ninvisible(lapply(files.sources, source))\ntrio.xls <- read_xlsx(\"../data/results_PSD-Trio-proteome_Two-sample_mod_T_2020-07-24.xlsx\")\ntrio.xls <- trio.xls %>% drop_na(logFC.WT.over.KO)\n```\nDoes the data have any underlying structure?\n\n```{r}\ntrio.abundances <- trio.xls %>% dplyr::select(starts_with(\"Trio_PSD_TMT11_Proteome..\"))\n\n#Renaming columns for clarity\ntrio.sampleSheet <- makeSampleSheet(trio.abundances)\ncolnames(trio.abundances) <- trio.sampleSheet$cleanId\n\n\n# Remove any rows with NA\ntrio.abundances.clean <- na.omit(trio.abundances)\ntrio.abundances.pca.plot <- makePcaPlot(trio.abundances.clean, trio.sampleSheet$color)\ntrio.abundances.pca.plot\n\n```\n\n\n\nDoes log transformation reveal any underlying structure?\n\n```{r}\n###\ntrio.abundances.clean.log <- log(trio.abundances.clean+abs(min(trio.abundances.clean))+1)\ntrio.abundances.clean.log.pca.plot <- makePcaPlot(trio.abundances.clean.log, trio.sampleSheet$color)\ntrio.abundances.clean.log.pca.plot\n\n# No inherent structure in the data\n# Samples do not vary primarily by genotype\n```\n\n\n\nHow does expresssion of Trio vary with genotype?\n```{r}\n# Check abundance of Trio protein\ntrio.trio.abundance.m <- getAbundanceOfProtein(trio.xls, \n                                             'Q0KL02',\n                                             \"Trio_PSD_TMT11_Proteome..\", \n                                             trio.sampleSheet)\ntrio.trio.abundance.plot <- makeAbundancePlot(trio.trio.abundance.m)\ntrio.trio.abundance.plot\n```\n\nThe Broad modeling (moderated t-test followed by FDR adjustment) finds that no genes, including Trio, are significantly altered after FDR adjustment of p-values. The following plot shows the distribution of FDR adjusted p-values. \n\n```{r}\nplot(density(trio.xls$adj.P.Val.WT.over.KO), xlim=c(0,1))\n```\nI am therefore using nominal p-values for further analysis of the data. Here is how the nominal p-value distribution looks like.\n\n```{r}\nplot(density(trio.xls$P.Value.WT.over.KO), xlim=c(0,1))\n```\n\nSince we are using nominal p-values, the chances of getting false positive hits is quite high. The number of proteins with p-values below 0.05 is:\n```{r}\nsum(trio.xls$P.Value.WT.over.KO < 0.05)\n```\n\n\n\nWhich proteins are the most consistently altered across replicates? Plotting LFC(KO/WT) against nominal p-value.\n\n```{r}\n#Plotting FDR adjusted p value against LFC\ntrio.xls <- trio.xls %>% dplyr::mutate(logFC.KO.over.WT = logFC.WT.over.KO*(-1))\nvPlot <- makeVolcanoPlot(trio.xls)\nvPlot\n```\n\n\nLabeling the genes that Borislav has picked out for further confirmation and has validated antibodies for. \n```{r}\nborislavLabels <- c(\"Trio\", \"Grin1\", \"Nrcam\", \"Dlgap1\", \"Clu\", \"Prrt1\", \"Zdhhc5\", \"Nono\", \"Cers6\", \"Uba52\", \"Rpl29\")\nvPlot2 <- makeVolcanoPlot(trio.xls, borislavLabels)\nvPlot2\n```\n\n\nDoes the MW of the protein dictate its LFC? To examine this, I divided all proteins into 6 color coded bins. The bins are unequal in size, so that I can see any representative effects at extremes. Bin 1 harbors the proteins with the smallest MW, bin 6 the largest MWs. \n```{r}\ntrio.xls <- trio.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))\ntrio.xls <- setupBins(trio.xls, \"log_protein_mw\", c(0,9.5,10.25,11.25,12,12.5,16))\nkeyvals <- colorizeBins(trio.xls)\nvPlot3 <- makeVolcanoPlot(trio.xls, NULL, 0.8, keyvals, c(0.1,0.9))\nvPlot3\n```\n\n\nIt does not look like the MW is associated with LFC. To examine this more systematically, I am using the same bins and plotting the cumulative frequency vs. LFC in each bin. \n```{r}\n#Stratify cumulative frequency by protein MW\nlfcCumFreqPlot <- makeStratifiedCumLfcPlot(trio.xls)\nlfcCumFreqPlot\n```\n\n\nIn each bin, proteins are as likely to upregulated as they are to be downregulated. Therefore, the MW of a protein does not dictate its LFC. Neither large nor small proteins aren't especially overabundant in Trio KO mice. \n\n\nMW is related but not wholly representative of the number of amino acids in a protein. Are the alterations in protein expression at the PSD with deletion of Trio associated with the number of amino acids in the protein (the protein length)?\n```{r}\n#Stratify by CDS length\ngeneLengths <- read.csv(\"~/bioChem/S3.genes.results\", sep=\"\\t\", header=T)\ngeneLengths <- geneLengths[,c(1:3)]\nresLen <- inner_join(trio.xls, geneLengths, by=c(\"geneSymbol\"=\"gene_id\"))\nresLen$aaSize <- resLen$length/3\nresLen$logAAsize <- log2(resLen$aaSize)\n##### CDS length distribution is shifted left in the PSD compared to tissue RF. Why??\nresLen <- setupBins(resLen, \"logAAsize\", c(0,6.5,7.5,9,10.5,12,16))\nkeyvals <- colorizeBins(resLen)\nvPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))\nvPlot4\n```\n\n\nIt does not look like LFC is dependent on protein length either. Analysing this more systematically now. \n```{r}\n# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins. \nlfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)\nlfcCumFreqPlot\n```\nWe can conclude that protein length is not associated with alteration in protein expression. \n\nCarrying out Gene Set Enrichment Analysis now. \n```{r}\n# Gene ontology analysis\ntrio.xls <- trio.xls %>% mutate(t.KO.over.WT = t.WT.over.KO*(-1))\ngoPathways <- \"~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt\"\ntrio.go <- doGoAnalysis(trio.xls, goPathways)\ntrio.go$up\ntrio.go$down\n```\n\n\n```{r}\ntrio.trio.abundance.m <- getAbundanceOfProtein(trio.xls, \n                                             'Q9CZR3',\n                                             \"Trio_PSD_TMT11_Proteome..\", \n                                             trio.sampleSheet)\ntrio.trio.abundance.plot <- makeAbundancePlot(trio.trio.abundance.m)\ntrio.trio.abundance.plot\n```\n\nAdd a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.\n\nWhen you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).\n",
    "created" : 1602790959219.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "72|6|80|0|\n89|6|91|0|\n94|6|96|0|\n140|6|152|0|\n156|6|160|0|\n164|6|171|0|\n",
    "hash" : "851995153",
    "id" : "C0ECA022",
    "lastKnownWriteTime" : 1602864138,
    "last_content_update" : 1602864138502,
    "path" : "~/Desktop/broad/psp/src/analysis.Rmd",
    "project_path" : "src/analysis.Rmd",
    "properties" : {
        "chunk_output_type" : "inline"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}