{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Shank3 PSD proteome analysis\"\noutput:\n  html_document: default\n  html_notebook: default\n---\n\nSameer Aryal //\nPostdoctoral Associate //\nSheng Laboratory //\nBroad Institute of MIT and Harvard //\n\nOct. 9, 2020 //\n\nHow does genetically removing Shank3 alter the postsynaptic density (PSD) proteome?\nExamining TMT labeled PSD proteome from WT, Shank3/+, and Shank3/Shank3 mice. \nExperiment carried out by Borislav Dejanovic. \n\n```{r}\n# Load data and libraries\nrm(list=ls())\nrequire(readxl)\nrequire(tidyverse)\nrequire(tm)\nrequire(ggfortify)\nrequire(PerformanceAnalytics)\nrequire(PCAtools)\nrequire(reshape2)\nrequire(ggbeeswarm)\nrequire(EnhancedVolcano)\nrequire(RColorBrewer)\nrequire(fgsea)\n```\n\n```{r}\nfiles.sources = list.files(\"../functions\" , full.names = TRUE)\ninvisible(lapply(files.sources, source))\nshank3.xls <- read_xlsx(\"../data/results_PSD-Shank3-proteome_Two-sample_mod_T_2020-07-22.xlsx\")\nshank3.xls <- shank3.xls %>% drop_na(logFC.WT.over.KO)\n```\nDoes the data have any underlying structure?\n\n```{r}\nshank3.abundances <- shank3.xls %>% dplyr::select(starts_with(\"Shank3_PSD_TMT11_Proteome..\"))\n\n#Renaming columns for clarity\nshank3.sampleSheet <- makeSampleSheet(shank3.abundances)\ncolnames(shank3.abundances) <- shank3.sampleSheet$cleanId\n\n\n# Remove any rows with NA\nshank3.abundances.clean <- na.omit(shank3.abundances)\nshank3.abundances.pca.plot <- makePcaPlot(shank3.abundances.clean, shank3.sampleSheet$color)\nshank3.abundances.pca.plot\n```\n\nDoes log transfromation reveal any underlying structure?\n\n```{r}\n###\nshank3.abundances.clean.log <- log(shank3.abundances.clean+abs(min(shank3.abundances.clean))+1)\nshank3.abundances.clean.log.pca.plot <- makePcaPlot(shank3.abundances.clean.log, shank3.sampleSheet$color)\nshank3.abundances.clean.log.pca.plot\n\n# No inherent structure in the data\n# Samples do not vary primarily by genotype\n```\n\nHow does expresssion of Shank3 vary with genotype?\nTwo Shank3 isoforms (SH3 and multiple ankyrin repeat domains protein 3 (overall?), and Isoform 9 of SH3 and multiple ankyrin repeat domains protein 3) were robustly measured in this experiment. Both are plotted. Both look like what one would expect, but hets are not quite halfway between WT and KO (similar to what's seen in the Trio experiment). \n\n```{r}\n# Check abundance of shank3 protein\n# Major isoform?\nshank3.shank3.abundance.m <- getAbundanceOfProtein(shank3.xls, \n                                             'A0A0A0MQD5',\n                                             \"Shank3_PSD_TMT11_Proteome..\", \n                                             shank3.sampleSheet)\nshank3.shank3.abundance.plot <- makeAbundancePlot(shank3.shank3.abundance.m)\nshank3.shank3.abundance.plot\n\n# Isoform 9\nshank3.shank3.iso.abundance.m <- getAbundanceOfProtein(shank3.xls, \n                                             \"Q4ACU6\",\n                                             \"Shank3_PSD_TMT11_Proteome..\", \n                                             shank3.sampleSheet)\nshank3.shank3.iso.abundance.plot <- makeAbundancePlot(shank3.shank3.iso.abundance.m)\nshank3.shank3.iso.abundance.plot\n\n```\n\n\nThe Broad modeling (moderated t-test followed by FDR adjustment) finds that no genes, including Shank3 (adj p-value of 0.19 for major isoform (KO/WT)), are significantly altered after FDR adjustment of p-values. The following plot shows the distribution of FDR adjusted p-values. \n\n```{r}\nplot(density(shank3.xls$adj.P.Val.WT.over.KO), xlim=c(0,1))\n```\n\n\nI am therefore using nominal p-values for further analysis of the data. Here is how the nominal p-value distribution looks like.\n\n```{r}\nplot(density(shank3.xls$P.Value.WT.over.KO), xlim=c(0,1))\n```\n\n\nSince we are using nominal p-values, the chances of getting false positive hits is quite high. The number of proteins with p-values below 0.05 is:\n```{r}\nsum(shank3.xls$P.Value.WT.over.KO < 0.05)\n```\n\n\nWhich proteins are the most consistently altered across replicates? Plotting LFC(KO/WT) against nominal p-value.\n\n```{r}\n#Plotting FDR adjusted p value against LFC\nshank3.xls <- shank3.xls %>% dplyr::mutate(logFC.KO.over.WT = logFC.WT.over.KO*(-1))\nvPlot <- makeVolcanoPlot(shank3.xls)\nvPlot\n```\n\nLabeling the genes that Borislav has picked out for further confirmation and has validated antibodies for. \n\n```{r}\nborislavLabels <- c(\"Trio\", \"Shank3\", \"Grin1\", \"Nrcam\", \"Dlgap1\", \"Clu\", \"Prrt1\", \"Zdhhc5\", \"Nono\", \"Cers6\", \"Uba52\", \"Rpl29\")\nvPlot2 <- makeVolcanoPlot(shank3.xls, borislavLabels)\nvPlot2\n```\n\n\nDoes the MW of the protein dictate its LFC? To examine this, I divided all proteins into 6 color coded bins. The bins are unequal in size, so that I can see any representative effects at extremes. Bin 1 harbors the proteins with the smallest MW, bin 6 the largest MWs. \n```{r}\nshank3.xls <- shank3.xls %>% dplyr::mutate(log_protein_mw = log(protein_mw))\nshank3.xls <- setupBins(shank3.xls, \"log_protein_mw\", c(0,9.5,10.25,11.25,12,12.5,16))\nkeyvals <- colorizeBins(shank3.xls)\nvPlot3 <- makeVolcanoPlot(shank3.xls, NULL, 0.8, keyvals)\nvPlot3\n```\n\n\nIt does not look like the MW is associated with LFC. To examine this more systematically, I am using the same bins and plotting the cumulative frequency vs. LFC in each bin.\n```{r}\n#Stratify cumulative frequency by protein MW\nlfcCumFreqPlot <- makeStratifiedCumLfcPlot(shank3.xls)\nlfcCumFreqPlot\n```\n\n\nIn each bin, proteins are as likely to upregulated as they are to be downregulated. Therefore, the MW of a protein does not dictate its LFC. Neither large nor small proteins aren't especially overabundant in Shank3 KO mice. \n\nMW is related but not wholly representative of the number of amino acids in a protein. Are the alterations in protein expression at the PSD with deletion of Trio associated with the number of amino acids in the protein (the protein length)?\n```{r}\n#Stratify by CDS length\ngeneLengths <- read.csv(\"~/bioChem/S3.genes.results\", sep=\"\\t\", header=T)\ngeneLengths <- geneLengths[,c(1:3)]\nresLen <- inner_join(shank3.xls, geneLengths, by=c(\"geneSymbol\"=\"gene_id\"))\nresLen$aaSize <- resLen$length/3\nresLen$logAAsize <- log2(resLen$aaSize)\n##### CDS length distribution is shifted left in the PSD compared to tissue RF. Why??\nresLen <- setupBins(resLen, \"logAAsize\", c(0,6.5,7.5,9,10.5,12,16))\nkeyvals <- colorizeBins(resLen)\nvPlot4 <- makeVolcanoPlot(resLen, NULL, 0.8, keyvals, c(0.1,0.9))\nvPlot4\n```\nIt does not look like LFC is dependent on protein length either. Analysing this more systematically now. \n\n```{r}\n# Lfcbins has changed now. Stratifying LFC cum freq w/ CDS length bins. \nlfcCumFreqPlot <- makeStratifiedCumLfcPlot(resLen)\nlfcCumFreqPlot\n```\nWe can conclude that protein length is not associated with alteration in protein expression. \n\nCarrying out Gene Set Enrichment Analysis now. \n```{r}\nshank3.xls <- shank3.xls %>% mutate(t.KO.over.WT = t.WT.over.KO*(-1))\ngoPathways <- \"~/Google Drive/seqTables/geneSets/c5.all.v7.0.symbols.gmt\"\nshank3.go <- doGoAnalysis(shank3.xls, goPathways)\nshank3.go$up\nshank3.go$down\n```\n\nAdd a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.\n\nWhen you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).\n",
    "created" : 1602598127367.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "18|6|32|0|\n34|6|39|0|\n42|6|54|0|\n58|6|66|0|\n131|6|137|0|\n141|6|145|0|\n151|6|163|0|\n166|6|170|0|\n",
    "hash" : "1556526261",
    "id" : "B63B9015",
    "lastKnownWriteTime" : 1602864054,
    "last_content_update" : 1602864054520,
    "path" : "~/Desktop/broad/psp/src/shank3.Rmd",
    "project_path" : "src/shank3.Rmd",
    "properties" : {
        "chunk_output_type" : "inline",
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}